<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Animacja 2</title>
  <meta name="description" content="Animacja 2">
  <meta name="author" content="Pawel Wozniak, 224868">

</head>

<body>
	<canvas id="canvas" width="800" height="600"></canvas>
  
	<script>
	  var canvas = document.getElementById('canvas');
	  var context = canvas.getContext('2d');
	  
	  var screenSizeX = 800;
	  var screenSizeY = 600;

	  var points = 0;
	  var time = 60;
	  
	  var textStatus = "WEEIArace";
	  var textPointsBase = "Points: ";
	  var textTimeBase = "Time: ";
	  var textPoints = textPointsBase + points;
	  var textTime = textTimeBase + time;

	  var Keys = {
		space: false,
        left: false,
        right: false,
		up: false,
        down: false
      };

	  function mainLoop() {
		clearScreen();

		drawStatusBar();
		drawStage();
		
		checkCollisions();

		if(time===0) {gameOver();}
	 }
	 	 
	 function clearScreen() {
		context.clearRect( 0, 0 , screenSizeX, screenSizeY );
	 }
	  

	 function drawStatusBar() {
		context.font = '24px serif';
		context.fillStyle = "black";
		var textSize = context.measureText(textStatus);
		context.fillText(textStatus,screenSizeX/2 - (context.measureText(textStatus)).width/2, 24);
		context.fillText(textPoints,screenSizeX-20- textSize.width, 24);
		context.fillText(textTime, 20, 24);
	}

	 function drawStage() {
		context.beginPath();
		context.rect(0, 0, screenSizeX, 32);
		context.rect(0, 0, screenSizeX, screenSizeY);
		context.lineWidth = 3;
		context.strokeStyle = '#003300';
		context.stroke();
	}

	function timeLoop() {
		time= time - 1;
		textTime = textTimeBase + time;
	}

	function gameOver() {
		clearInterval(t1);
		clearInterval(t2);
		showResult();
	}

	function showResult() {
	  context.fillStyle = "white";
      context.fillRect(100,100, screenSizeX-200, screenSizeY-200);
      context.font = "70pt sans-serif";
	  var result = "Wynik: "+points;
      context.strokeText(result, screenSizeX/2 - (context.measureText(result)).width/2, 300);
	  context.font = "20pt sans-serif";
	  context.fillStyle = "black";
	  var text = "Press ENTER to try again";
	  context.fillText(text, screenSizeX/2 - (context.measureText(text)).width/2, 400);
	  context.stroke();
	  window.onkeyup = function(e) {
		var kc = e.keyCode;
		e.preventDefault();
		if (kc === 13) window.location.reload();
	};
	}
		 
	window.onkeyup = function(e) {
		var kc = e.keyCode;
		e.preventDefault();

		if (kc === 37) Keys.right = false;
		if (kc === 39) Keys.left = false;
		if (kc === 38) Keys.up = false;
		if (kc === 40) Keys.down = false;
		if (kc === 32) Keys.space = false;
	};
	window.onkeydown = function(e) {
		var kc = e.keyCode;
		e.preventDefault();

		if (kc === 37) Keys.right = true; 
		if (kc === 39) Keys.left = true;
		if (kc === 38) Keys.up = true;
		if (kc === 40) Keys.down = true;
		if (kc === 32) Keys.space = true;
	};


	var t1=setInterval(mainLoop,20);
	var t2=setInterval(timeLoop,1000);
	  
	</script>
</body>

</body>
</html>
